<!-- Purpose: This file will contain the HTML structure for the Analytics interface, accessible only by managers. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Leads - Analytics</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
</head>
<!-- Navbar -->
<nav id="navbar">
    <ul>
        <!-- Show the role on the left side -->
        <li style="float: left; background-color: #007bff; color: white; padding: 8px 25px; list-style: none;">
            <div> Role: {{ role }} </div>
            <div> Nickname: {{ nickname }} </div>
        </li>

        <!-- Menu links to the other pages -->
        {% if role != 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('data_collection') }}">Data Collection</a></li>
        {% endif %}
        {% if role != 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('field_support') }}">Field Support</a></li>
        {% endif %}
        {% if role != 'Canvasser' %}
        <li style="float: right;"><a href="{{ url_for('prospect_qualification') }}">Prospect Qualification</a></li>
        {% endif %}
        {% if role == 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('analytics') }}">Analytics</a></li>
        {% endif %}
        <li style="float: right;"><a href="{{ url_for('role_selection') }}">Change Role</a></li>
    </ul>
</nav>
<body>
    <div class="flex-container">
        <h1>Analytics Page</h1>      
        <h2>Team's Overview</h2>
        <div class="performance-grid team-overview">
            <div class="performance-item">
                <h2 id="team-members">-</h2>
                <p>Team members</p>
            </div>
            <div class="performance-item">
                <h2 id="total-doors">-</h2>
                <p>Doors knocked by the team in total</p>
            </div>
            <div class="performance-item">
                <h2 id="total-appointments">-</h2>
                <p>Appointments set by the team in total</p>
            </div>
            <div class="performance-item">
                <h2 id="avg-doors-per-day">-</h2>
                <p>Doors knocked on average per day / team member</p>
            </div>
            <div class="performance-item">
                <h2 id="avg-appointments-per-day">-</h2>
                <p>Appointments set on average per day / team member</p>
            </div>
            <div class="performance-item">
                <h2 id="avg-conversion-rate">-</h2>
                <p>Average Conversion Rate per employee</p>
            </div>
            <div class="performance-item">
                <h2 id="days-of-collection">-</h2>
                <p>Days of data collection</p>
            </div>
        </div>

        <h2>Team's Performances</h2>
        <p class="data-tip"><strong>Tip:</strong> Use the button on the left to select which type of data visualize, and the one on the right to switch between 'total' and 'daily' data.</p>
        <div class="chart-container">
            <div class="chart-controls">
                <select id="metric-select">
                    <option value="appointments">Appointments Set</option>
                    <option value="doors">Doors Knocked</option>
                    <option value="conversion">Conversion Rate</option>
                </select>
                <button id="toggle-view">Total / Daily</button>
            </div>
            <canvas id="teamPerformanceChart"></canvas>
        </div>
        
        
        <h2>Prospects' Responses</h2>
        <p class="data-tip"><strong>Tip:</strong> Click on an element in the Legend to exclude/include it in the chart.</p>
        <div class="chart-container" style="position: relative; height:80vh; width:80vw; margin: auto;">
            <canvas id="prospectResponsesChart"></canvas>
        </div>

        <h2>Reasons of No</h2>
        <p class="data-tip"><strong>Tip:</strong> Click on an element in the Legend to exclude/include it in the chart.</p>
        <div class="chart-container" style="position: relative; height:80vh; width:80vw; margin: auto;">
            <canvas id="reasonsOfNoChart"></canvas>
        </div>

        <h2>Insights & Suggestions</h2>
        <p class="data-tip"><strong>Potential future updates:</strong> This section will display real-time insights and suggestions generated by a commercial or open-source LLM (e.g., ChatGPT, Claude, or Llama). 
            The LLM will be regularly queried through an API (for commercial models) or hosted on a private server (for open-source models), continually updated with current data to provide actionable recommendations for improvements in the business.</p>

    </div>
</body>
</html>
