<!-- Purpose: This file will contain the HTML structure for the Data Collection interface, accessible by both canvassers and managers. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Collection</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</head>
<!-- Navbar -->
<nav id="navbar">
    <ul>
        <!-- Show the role on the left side -->
        <li style="float: left; background-color: #007bff; color: white; padding: 8px 25px; list-style: none;">
            <div> Role: {{ role }} </div>
            <div> Nickname: {{ nickname }} </div>
        </li>

        <!-- Menu links to the other pages -->
        {% if role != 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('data_collection') }}">Data Collection</a></li>
        {% endif %}
        {% if role != 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('field_support') }}">Field Support</a></li>
        {% endif %}
        {% if role != 'Canvasser' %}
        <li style="float: right;"><a href="{{ url_for('prospect_qualification') }}">Prospect Qualification</a></li>
        {% endif %}
        {% if role == 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('analytics') }}">Analytics</a></li>
        {% endif %}
        <li style="float: right;"><a href="{{ url_for('role_selection') }}">Change Role</a></li>
    </ul>
</nav>
<body>

    <div class="flex-container">
        <h1>Data Collection Page</h1> 
        <div class="form-section">
            <h2>Submission Form</h2>
            <p>Please fill out the form below. Fields marked with an asterisk (*) are mandatory.</p>
            <form action="{{ url_for('submit_data') }}" method="post">
                <!-- Mandatory Fields -->
                <div class="form-group">
                    <label for="address">Address *</label>
                    <input type="text" id="address" name="address" required>
                </div>
                <div class="form-group">
                    <label for="timestamp">Timestamp (time of contact) *</label>
                    <input type="datetime-local" id="timestamp" name="timestamp" required>
                </div>
                <div class="form-group">
                    <label for="prospect_response">Prospect Response *</label>
                    <select id="prospect_response" name="prospect_response" required>
                        <option value="">--Select a response--</option>
                        <option value="No answer">No answer</option>
                        <option value="Direct no (Homeowner)">Direct no (Homeowner)</option>
                        <option value="Direct no (Renter)">Direct no (Renter)</option>
                        <option value="Return later">Return later</option>
                        <option value="Initial conversation">Initial conversation</option>
                        <option value="Detailed conversation">Detailed conversation</option>
                        <option value="Appointment set">Appointment set</option>
                        <option value="Undefined">Undefined</option>
                    </select>
                </div>
                <!-- Optional Fields -->
                <div class="form-group">
                    <label for="reason_of_no">Reason for 'No' (if applicable)</label>
                    <select id="reason_of_no" name="reason_of_no">
                        <option value="">--Select a reason--</option>
                        <option value="Reason not provided">Reason not provided</option>
                        <option value="Already got solar panels on rooftop">Already got solar panels on rooftop</option>
                        <option value="Does not make economical sense">Does not make economical sense</option>
                        <option value="Electricity bill is already low">Electricity bill is already low</option>
                        <option value="Cannot get incentives from government">Cannot get incentives from government</option>
                        <option value="Busy at the moment / other priorities">Busy at the moment / other priorities</option>
                        <option value="Too old">Too old</option>
                        <option value="Rooftop too steep">Rooftop too steep</option>
                        <option value="Rooftop to renovate first">Rooftop to renovate first</option>
                        <option value="Does not trust door knocking people">Does not trust door knocking people</option>
                        <option value="Soon moving out / selling the house">Soon moving out / selling the house</option>
                        <option value="Already agreed with competitor">Already agreed with competitor</option>
                        <option value="Too much shading">Too much shading</option>
                        <option value="Other (explain in Comments)">Other (explain in Comments)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="electricity_bill_estimate">Electricity Bill Estimate</label>
                    <input type="text" id="electricity_bill_estimate" name=electricity_bill_estimate>
                </div>
                <div class="form-group">
                    <label for="approximate_age">Approximate Age</label>
                    <input type="number" id="approximate_age" name="approximate_age">
                </div>
                <div class="form-group">
                    <label for="presumed_gender">Presumed Gender</label>
                    <input type="text" id="presumed_gender" name="presumed_gender">
                </div>
                <div class="form-group">
                    <label for="presumed_family_status">Presumed Family Status (single, married,...)</label>
                    <input type="text" id="presumed_family_status" name="presumed_family_status">
                </div>
                <div class="form-group">
                    <label for="solar_panels_on_roof">Solar Panels on Roof</label>
                    <select id="solar_panels_on_roof" name="solar_panels_on_roof">
                        <option value="">--Select an option--</option>
                        <option value="Yes">Yes</option>
                        <option value="No">No</option>
                        <option value="Unknown">Unknown</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="house_characteristics">House Characteristics</label>
                    <input type="text" id="house_characteristics" name="house_characteristics">
                </div>
                <div class="form-group">
                    <label for="interest_level">Interest level</label>
                    <select id="interest_level" name="interest_level">
                        <option value="">--Select an interest level--</option>
                        <option value="Zero">Zero</option>
                        <option value="Low">Low interest</option>
                        <option value="Medium">Medium interest</option>
                        <option value="High">High interest</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="additional_notes">Additional Notes / Comments</label>
                    <textarea id="additional_notes" name="additional_notes"></textarea>
                </div>
                <!-- Submit Button -->
                <button type="submit">Submit Data</button>
            </form>
        </div>

        <!-- Toggle button for form visibility -->
        <button id="toggle-form">Hide Form</button>
        
        <!-- Add the table to display CSV data -->
        <h2>Collected Data</h2>
        <!-- Delete all button to delete all data from table -->
        <button class="delete-all-btn" id="delete-all-btn">Delete all</button>
        <table border="1">
            <thead>
                <tr>
                    <th></th>
                    <th>Prospect ID</th>
                    <th>Address</th>
                    <th>Timestamp</th>
                    <th>Prospect Response</th>
                    <th>Reason for 'No'</th>
                    <th>Electricity Bill Estimate</th>
                    <th>Approximate Age</th>
                    <th>Presumed Gender</th>
                    <th>Presumed Family Status</th>
                    <th>Solar Panels on Roof</th>
                    <th>House Characteristics</th>
                    <th>Interest Level</th>
                    <th>Additional Notes / Comments</th>
                    <th>Submitted by</th>
                </tr>
            </thead>
            <tbody>
                {% if data %}
                    {% for row in data %}
                        <tr>
                            <td class="delete-cell-column">
                                <button class="delete-btn" data-id="{{ row[0] }}">X</button>
                            </td>
                            {% for cell in row %}
                                <td>{{ cell }}</td>
                            {% endfor %}
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="14">No data available yet.</td>
                        </tr>
                    {% endfor %}
                {% endif %}
            </tbody>
        </table>
    </div>
</body>
</html>
