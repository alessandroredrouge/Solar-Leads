<!-- Purpose: This file will contain the HTML structure for the Field Support interface, accessible by both canvassers and managers. -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar Leads - Field Support</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script src="{{ url_for('static', filename='config.js') }}"></script>
    <script src="{{ url_for('static', filename='maps.js') }}"></script>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
</head>
<!-- Navbar -->
<nav id="navbar">
    <ul>
        <!-- Show the role on the left side -->
        <li style="float: left; background-color: #007bff; color: white; padding: 8px 25px; list-style: none;">
            <div> Role: {{ role }} </div>
            <div> Nickname: {{ nickname }} </div>
        </li>

        <!-- Menu links to the other pages -->
        {% if role != 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('data_collection') }}">Data Collection</a></li>
        {% endif %}
        {% if role != 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('field_support') }}">Field Support</a></li>
        {% endif %}
        {% if role != 'Canvasser' %}
        <li style="float: right;"><a href="{{ url_for('prospect_qualification') }}">Prospect Qualification</a></li>
        {% endif %}
        {% if role == 'Manager' %}
        <li style="float: right;"><a href="{{ url_for('analytics') }}">Analytics</a></li>
        {% endif %}
        <li style="float: right;"><a href="{{ url_for('role_selection') }}">Change Role</a></li>
    </ul>
</nav>
<body>
    <div class="flex-container">
        <h1>Field Support Page</h1>
        <h2>Today's performance</h2>
        <div class="date-selector">
            <label for="date-select">Select Date:</label>
            <input type="date" id="date-select" value="{{ selected_date }}">
        </div>
        <!-- TODO: update the dates here indicated for the new dataset -->
        <p class="data-tip"><strong>Tip:</strong> The data of the pre-populated dataset created for the demo go from the 28th of August 2024 to the 28th of September 2024, weekends included.
            Select a date in this range to visualize the related data.</p>
    
        <div class="performance-grid">
            <div class="performance-item">
                <h2>{{ performance.doors_knocked }}</h2>
                <p>Doors knocked today</p>
            </div>
            <div class="performance-item">
                <h2>{{ performance.appointments_set }}</h2>
                <p>Appointment{{ 's' if performance.appointments_set != 1 else '' }} set today</p>  <!--  FIXME: the adding or removing of the 's' doesn't work-->
            </div>
            <div class="performance-item">
                <h2>{{ performance.rank_doors_knocked }}</h2>
                <p>in Doors knocked today within your team</p>
            </div>
            <div class="performance-item">
                <h2>{{ performance.rank_appointments_set }}</h2>
                <p>in Appointments set today within your team</p>
            </div>
            <div class="performance-item">
                <h2>{{ performance.doors_away }}</h2>
                <p>Doors away from your daily goal</p>
            </div>
            <div class="performance-item">
                <h2>{{ performance.conv_rate}}</h2>
                <p>your Conversion Rate today</p>
            </div>
        </div>

        <h2>Prospects' map</h2>
        <p class="data-tip"><strong>Tip:</strong> Customize your map view by toggling elements on or off using the Legend icons, and click on individual map markers to reveal detailed information about each data point.</p>
        <div id="map" style="height: 500px; width: 100%;"></div>

         <h2>Suggested route</h2> <!--TODO: complete this part -->
         <p class="data-tip"><strong>Potential future updates:</strong> This section will present an optimized route suggestion, balancing high-priority targets (such as addresses with the highest predicted conversion rates from the ad-hoc developed ML model and previously unvisited houses) with efficient travel time between locations.</p>

        <h2>Pitch recap</h2>
        <p class="data-tip"><strong>Tip:</strong> Customize the pitch to suit your needs and save your personalized version.</p>
        <div id="pitch-recap">
            <textarea id="pitch-box" readonly></textarea>
            <div class="pitch-buttons">
                <button id="edit-btn">Edit</button>
                <button id="save-btn" style="display: none;">Save</button>
            </div>
        </div>

        <h2>Overall performance</h2>
        <div class="performance-grid overall-performance">
            <div class="performance-item">
                <h2 id="total-doors-knocked">-</h2>
                <p>Doors you knocked since you started</p>
            </div>
            <div class="performance-item">
                <h2 id="total-appointments-set">-</h2>
                <p>Appointments set since you started</p>
            </div>
            <div class="performance-item">
                <h2 id="average-conv-rate">-</h2>
                <p>Your average Conversion Rate</p>
            </div>
            <div class="performance-item">
                <h2 id="days-since-started">-</h2>
                <p>Days since you started</p>
            </div>
        </div>

        <div id="sync-status"></div>
    </div>
</body>
</html>
